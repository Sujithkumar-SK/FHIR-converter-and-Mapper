<div class="row justify-content-center align-items-center min-vh-100">
  <div class="col-12 col-md-8 col-lg-6 col-xl-5">
    <div class="card shadow-lg border-0 auth-card">
      <div class="card-header text-white text-center py-4">
        <div class="mb-3">
          <i class="fas fa-shield-check fa-3x mb-3 text-white"></i>
        </div>
        <h2 class="mb-0 fw-bold">
          <i class="fas fa-key me-2"></i>
          Email Verification
        </h2>
        <p class="mb-0 mt-2 opacity-90 fs-5">Secure Account Activation</p>
        <small class="opacity-75">Enter the 6-digit verification code sent to your email</small>
      </div>
      
      <div class="card-body">
        <!-- Success Alert -->
        <div *ngIf="successMessage" class="alert alert-success alert-dismissible fade show" role="alert">
          <i class="fas fa-check-circle me-2"></i>
          {{ successMessage }}
          <div class="mt-3">
            <div class="d-flex align-items-center justify-content-center">
              <div class="spinner-border spinner-border-sm text-success me-2" role="status"></div>
              <small class="text-success fw-bold">Redirecting to dashboard...</small>
            </div>
          </div>
        </div>

        <!-- Error Alert -->
        <div *ngIf="errorMessage" class="alert alert-danger alert-dismissible fade show" role="alert">
          <i class="fas fa-exclamation-triangle me-2"></i>
          {{ errorMessage }}
          <button type="button" class="btn-close" (click)="errorMessage = ''" aria-label="Close"></button>
        </div>

        <!-- Email Info Card -->
        <div *ngIf="otpData" class="alert alert-info mb-4 border-0">
          <div class="row align-items-center">
            <div class="col-auto">
              <i class="fas fa-envelope fa-2x text-info"></i>
            </div>
            <div class="col">
              <div class="fw-bold">Verification sent to:</div>
              <div class="text-dark">{{ otpData.email }}</div>
              <div class="mt-2">
                <i class="fas fa-clock me-1"></i>
                <small class="fw-bold">Time remaining: </small>
                <span class="badge bg-warning text-dark fs-6 px-3 py-2">{{ formatTime(timeLeft) }}</span>
              </div>
            </div>
          </div>
        </div>

        <form [formGroup]="otpForm" (ngSubmit)="onSubmit()" *ngIf="!successMessage">
          <!-- OTP Input -->
          <div class="mb-4">
            <label for="otp" class="form-label text-center d-block">
              <i class="fas fa-key me-2 text-primary"></i>Enter Verification Code
            </label>
            <input
              type="text"
              id="otp"
              formControlName="otp"
              class="form-control form-control-lg text-center otp-input"
              [class.is-invalid]="isFieldInvalid('otp')"
              placeholder="000000"
              maxlength="6">
            <div *ngIf="isFieldInvalid('otp')" class="invalid-feedback text-center">
              {{ getFieldError('otp') }}
            </div>
            <div class="form-text text-center mt-3">
              <i class="fas fa-info-circle me-1 text-primary"></i>
              <span class="text-muted">Check your email for the 6-digit verification code</span>
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="row g-3 mb-4">
            <div class="col-12">
              <button
                type="submit"
                class="btn btn-success btn-lg w-100 py-3"
                [disabled]="isLoading || otpForm.invalid || timeLeft <= 0">
                <span *ngIf="isLoading" class="spinner-border spinner-border-sm me-2" role="status"></span>
                <i *ngIf="!isLoading" class="fas fa-check-circle me-2"></i>
                {{ isLoading ? 'Verifying Code...' : 'Verify & Activate Account' }}
              </button>
            </div>
            <div class="col-12">
              <button
                type="button"
                class="btn btn-outline-secondary btn-lg w-100"
                (click)="resendOtp()"
                [disabled]="isLoading || timeLeft > 0">
                <i class="fas fa-redo me-2"></i>
                {{ timeLeft > 0 ? 'Resend available in ' + formatTime(timeLeft) : 'Resend Verification Code' }}
              </button>
            </div>
          </div>
        </form>

        <!-- Navigation Links -->
        <div class="text-center">
          <div class="border-top pt-4">
            <p class="mb-3 text-muted">Need to make changes?</p>
            <a routerLink="/auth/register" class="btn btn-outline-primary btn-lg">
              <i class="fas fa-arrow-left me-2"></i>Back to Registration
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>